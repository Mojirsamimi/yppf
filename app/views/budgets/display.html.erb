
<h1><center>Budget</center></h1>

<p id="notice"><%= notice %></p>

<!-- <%= pie_chart Expense.group(:expensetype, :month, :year).sum(:projvalue)%> -->
<!-- <%=pie_chart Income.group(:incometype, :month, :year).sum(:value)%> -->

<h2>Income</h2>

<table style = "width:100%">
  <thead>
    <tr>
      <th>Income</th>
      <th>Type</th>
      <th>Value</th>
      <th>Frequency</th>
      <th>Day Received</th>
      <th>Month</th>
      <th>Year</th>
      <th colspan="3"></th>
    </tr>
  </thead>

  <tbody>
    <% @incomes.each do |income| %>
      <tr>
        <td><%= income.income %></td>
        <td><%= income.incometype %></td>
        <td><%= income.value %></td>
        <td><%= income.frequency %></td>
        <td><%= income.day_rec %></td>
        <td><%= income.month %></td>
        <td><%= income.year %></td>
        <td><%= link_to 'Edit', edit_income_path(income) %></td>
        <td><%= link_to 'Destroy', income, method: :delete, data: { confirm: 'Are you sure?' } %></td>
      </tr>
    <% end %>
  </tbody>
</table>

<br>
<%= link_to 'New Income', new_income_path %>
<br>
<br>

<% @expenses.each do |expense| %>
  <%= "#{expense.expenseid} - #{((expense.actvalue / expense.projvalue) * 100).to_i}% of monthly budget used" %>
    <% if ((expense.actvalue / expense.projvalue) * 100) > 75 %>
      <div class="progress">
        <div class="progress-bar progress-bar-danger" role="progressbar" aria-valuenow="<%= expense.actvalue%>" aria-valuemin="0" aria-valuemax="<%= expense.projvalue %>" style="width: <%= (expense.actvalue / expense.projvalue) * 100 %>%">
        </div>
      </div>
    <% elsif ((expense.actvalue / expense.projvalue) * 100) > 50%>
      <div class="progress">
        <div class="progress-bar progress-bar-warning" role="progressbar" aria-valuenow="<%= expense.actvalue%>" aria-valuemin="0" aria-valuemax="<%= expense.projvalue %>" style="width: <%= (expense.actvalue / expense.projvalue) * 100 %>%">
        </div>
      </div>
    <% else %>
      <div class="progress">
        <div class="progress-bar progress-bar-success" role="progressbar" aria-valuenow="<%= expense.actvalue%>" aria-valuemin="0" aria-valuemax="<%= expense.projvalue %>" style="width: <%= (expense.actvalue / expense.projvalue) * 100 %>%">
        </div>
      </div>
    <% end %>
<% end %>

<br>

<div class="progress" aria-valuemax="252.95">
  <% @expenses.each do |expense| %>
    <div class="progress-bar progress-bar-info" role="progressbar" aria-valuenow="<%= expense.actvalue%>" aria-valuemin="0" aria-valuemax="<%= expense.projvalue %>" style="width: <%= expense.actvalue %>%">
    </div>
  <% end %>
</div>

<h2>Expenses</h2>
<table style = "width:100%">
  <thead>
    <tr>
      <th>Expense</th>
      <th>Type</th>
      <th>Frequency</th>
      <th>Projected Value</th>
      <th>Actual Value</th>
      <th>Percent </th>
      <th>Month</th>
      <th>Year</th>
      <th colspan="3"></th>
    </tr>
  </thead>

  <tbody>
    <% @expenses.each do |expense| %>
      <tr>
        <td><%= expense.expenseid %></td>
        <td><%= expense.expensetype %></td>
        <td><%= expense.frequency %></td>
        <td><%= expense.projvalue %></td>
        <td><%= expense.actvalue %></td>
        <td><%= expense.percent %></td>
        <td><%= expense.month %></td>
        <td><%= expense.year %></td>
        <td><%= link_to 'Edit', edit_expense_path(expense) %></td>
        <td><%= link_to 'Destroy', expense, method: :delete, data: { confirm: 'Are you sure?' } %></td>
      </tr>
    <% end %>
  </tbody>
</table>
<br>

<%= link_to 'New Expense', new_expense_path %>
<br>


<h2>Bills</h2>
<table style = "width:100%">
  <thead>
    <tr>
      <th>Income</th>
      <th>Type</th>
      <th>Value</th>
      <th>Frequency</th>
      <th>Day Received</th>
      <th>Month</th>
      <th>Year</th>
      <th colspan="3"></th>
    </tr>
  </thead>

  <tbody>
    <% @bills.each do |bill| %>
      <tr>
        <td><%= bill.expenseid %></td>
        <td><%= bill.day_month %></td>
        <td><%= bill.month %></td>
        <td><%= bill.year %></td>
        <td><%= link_to 'Edit', edit_bill_path(bill) %></td>
        <td><%= link_to 'Destroy', bill, method: :delete, data: { confirm: 'Are you sure?' } %></td>
      </tr>
    <% end %>

  </tbody>
</table>
<br>

<%= link_to 'New Bill', new_bill_path %>
<br>


<center><%= link_to 'Back to Dashboard', dashboard_new_path %></center>
